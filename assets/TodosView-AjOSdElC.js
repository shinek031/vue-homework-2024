import{d as a,u as G,h as N,i as O,c as d,a as t,t as _,j as u,w as $,v as V,n as T,F as A,k as B,o as v,l as I}from"./index-CNe2iPz5.js";import{a as r,C as F,G as J,D as E,I as P,T as R,c as j}from"./axios-D1a_d0j8.js";const q={id:"todoListPage",class:"bg-half"},H=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),K={class:"todo_sm"},Q={href:"#"},W={class:"conatiner todoListPage vhContainer"},X={class:"todoList_Content"},Y={class:"inputBox"},Z=t("i",{class:"bi bi-plus"},null,-1),ee=[Z],te={class:"todoList_list"},se={class:"todoList_tab"},oe={class:"todoList_items"},ae={class:"todoList_item"},le={class:"todoList_label"},ne=["onUpdate:modelValue","onClick"],ie=["onClick"],ue=t("i",{class:"bi bi-x-circle-fill"},null,-1),re=[ue],ce={class:"todoList_statistics"},de={key:0},ve={key:1},fe={__name:"TodosView",setup(he){const p=a(""),l=a(""),k=a(""),f=G(),c=a(""),w=a(""),L=a(!1),n=a("all");N(async()=>{await x()});const x=async()=>{if(l.value=document.cookie.replace(/(?:(?:^|.*;\s*)userTodo\s*\=\s*([^;]*).*$)|^.*$/,"$1"),l.value)try{const e=await r.get(`${F}`,{headers:{Authorization:l.value}});e.data.status==!0&&(p.value=e.data.nickname,await h())}catch{setTimeout(()=>{document.cookie="userTodo=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",f.push({name:"singin"})},3e3)}else setTimeout(()=>{document.cookie="userTodo=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",f.push({name:"singin"})},3e3)},i=a(""),y=a(""),C=a(""),b=O(()=>n.value=="true"?i.value.filter(e=>e.status):n.value=="false"?i.value.filter(e=>!e.status):i.value),U=async()=>{C.value=i.value.filter(e=>e.status),y.value=i.value.filter(e=>!e.status)},M=async e=>{try{await r.delete(`${E(e)}`,{headers:{authorization:l.value}}),h()}catch(s){k.value=s.response.data.message,console.log(s.response.data.message)}},g=e=>{n.value=e},h=async()=>{try{const e=await r.get(`${J}`,{headers:{authorization:l.value}});console.log(e),e.data.status==!0&&(i.value=e.data.data,U())}catch(e){console.log(e.response.data.message)}},z=async()=>{try{if(!c.value){alert(`${p.value.nickname}，您尚未輸入代辦事項唷`);return}const e={content:""};e.content=c.value;const s=await r.post(`${P}`,e,{headers:{authorization:l.value}});w.value=s.data,L.value=!0,c.value="",h()}catch(e){k.value=e.response.data.message}},S=async e=>{if(l.value){console.log("toggleStatus:"+e);try{const s=await r.patch(`${R(e)}`,{},{headers:{Authorization:l.value}});await h()}catch(s){console.log(s.response.data.message)}}},D=async()=>{const e=await r.post(`${j}`,{},{headers:{Authorization:l.value}});console.log(e),e.data.status?document.cookie="userTodo=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/":alert(e.data.message),setTimeout(()=>{f.push({name:"singin"})},3e3)};return(e,s)=>(v(),d("div",q,[t("nav",null,[H,t("ul",null,[t("li",K,[t("a",Q,[t("span",null,_(p.value)+"的代辦",1)])]),t("li",null,[t("a",{href:"#",onClick:u(D,["prevent"])},"登出")])])]),t("div",W,[t("div",X,[t("div",Y,[$(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>c.value=o),placeholder:"請輸入待辦事項"},null,512),[[V,c.value]]),t("a",{href:"#",onClick:u(z,["prevent"])},ee)]),t("div",te,[t("ul",se,[t("li",null,[t("a",{href:"#",class:T({active:n.value=="all"}),onClick:s[1]||(s[1]=u(o=>g("all"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:T({active:n.value=="false"}),onClick:s[2]||(s[2]=u(o=>g("false"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:T({active:n.value=="true"}),onClick:s[3]||(s[3]=u(o=>g("true"),["prevent"]))},"已完成",2)])]),t("div",oe,[t("ul",ae,[(v(!0),d(A,null,B(b.value,o=>(v(),d("li",{key:o.id},[t("label",le,[$(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":m=>o.status=m,onClick:m=>S(o.id)},null,8,ne),[[I,o.status]]),t("span",null,_(o.content),1)]),t("a",{href:"#",onClick:u(m=>M(o.id),["prevent"])},re,8,ie)]))),128))]),t("div",ce,[n.value=="true"?(v(),d("p",de,_(C.value.length)+" 個已完成項目",1)):(v(),d("p",ve,_(y.value.length)+" 個待完成項目",1))])])])])])]))}};export{fe as default};
